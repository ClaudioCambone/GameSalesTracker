<!DOCTYPE html>
<html>

<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <%= stylesheet_link_tag 'cards', media: 'all' %>
  <%= stylesheet_link_tag 'application', media: 'all' %>
</head>

<body>
  <div class="container">
    <% if @games.present? %>
      <br><br>
      <div class="row row-cols-1 row-cols-md-3">
        <% displayed_titles = Set.new %>
        <% @games.each do |game| %>
          <% title = game['title'] %>
          <% unless displayed_titles.include?(title) %>
          <div class="col mb-4">
          <div class="card">
            <div class="image-container">
              <%= link_to details_game_path(plain: game['plain']) do %>
                <%= image_tag(game['image_url'] || 'placeholder.png', class: 'card-img-top img-fluid', alt: game['title']) %>
              <% end %>
            </div>
            <div class="card-body">
              <h5 class="card-title text-center">
                <%= link_to details_game_path(plain: game['plain']) do %>
                  <%= game['title'] %>
                <% end %>
              </h5>
              <p class="card-text text-center">
                <del><%= number_to_currency(game['price_old'], unit: '', format: '%n %u') %></del>
                <span class="fw-bold fs-3"><%= number_to_currency(game['price_new'], unit: 'â‚¬', format: '%n %u') %></span>
              </p>
              <% discount_percent = 100 - ((game['price_new'].to_f / game['price_old'].to_f) * 100).round(2) %>
              <div class="text-center fw-bold fs-5">
                Get <%= number_with_precision(discount_percent, precision: 1) %>% off!
              </div>         
            </div>
          </div>
        </div>
            <% displayed_titles.add(title) %>
          <% end %>
        <% end %>
      </div>
    <% else %>
      <p>Risultati della ricerca:</p>
      <p>Nessun risultato trovato.</p>
    <% end %>
  </div>
</body>

</html>